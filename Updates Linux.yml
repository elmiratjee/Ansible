---
  - name: installing apt playbook
    hosts: all
    become: yes
    become_user: root    
    tasks:
      - name: Gathering all updates
        apt:
          upgrade: dist
      - name: Upgrade all packages on servers
        apt:
          name: "*"
          state: latest
      - name: ensure repository key is installed
        apt_key:
          url: https://download.docker.com/linux/ubuntu/gpg
          state: present

      - name: ensure docker registry is available
        apt_repository: repo='deb https://download.docker.com/linux/ubuntu bionic stable' state=present

      - name: ensure docker and dependencies are installed
        apt: name=docker-ce update_cache=yes